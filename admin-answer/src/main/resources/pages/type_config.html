<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title> - 考试配置</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico">
    <link href="/static/pages/hAdmin/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="/static/pages/hAdmin/css/font-awesome.css?v=4.4.0" rel="stylesheet">

    <!-- Data Tables -->
    <link href="/static/pages/hAdmin/css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">

    <link href="/static/pages/hAdmin/css/animate.css" rel="stylesheet">
    <link href="/static/pages/hAdmin/css/style.css?v=4.1.0" rel="stylesheet">

</head>

<body class="gray-bg">
<button type="button" class="btn btn-w-m button-add btn-success">添加</button>
<div id="tree">

</div>

<div id="add" style="padding:20px;display: none;">
    <input type="hidden" id="form-id"/>
    <div class="form-group">
        <label>类型名称</label>
        <input type="text" id="form-name" placeholder="请输入名称" class="form-control">
    </div>
</div>

<!-- 全局js -->
<script src="/static/pages/hAdmin/js/jquery.min.js?v=2.1.4"></script>
<script src="/static/pages/hAdmin/js/bootstrap.min.js?v=3.3.6"></script>


<script src="/static/pages/hAdmin/js/plugins/jeditable/jquery.jeditable.js"></script>

<!-- Data Tables -->
<script src="/static/pages/hAdmin/js/plugins/dataTables/jquery.dataTables.js"></script>
<script src="/static/pages/hAdmin/js/plugins/dataTables/dataTables.bootstrap.js"></script>

<!-- 自定义js -->
<script src="/static/pages/hAdmin/js/content.js?v=1.0.0"></script>

<!-- layer javascript -->
<script src="/static/pages/hAdmin/js/plugins/layer/layer.min.js"></script>
<!-- Page-Level Scripts -->

<!-- layerDate plugin javascript -->
<script src="/static/pages/hAdmin/js/plugins/layer/laydate/laydate.js"></script>
<script src="/static/pages/hAdmin/js/demo/timeutil.js"></script>
<script src="/static/pages/hAdmin/js/plugins/treeview/bootstrap-treeview.js"></script>

<script>
    var tree = [];

    function getText(text, pid, id) {

        if (pid == 0) {
            text += '&nbsp;<a data-id="' + id + '" class="tree-add">添加</a>'
        }
        text += '&nbsp;<a data-id="' + id + '" data-pid="' + pid + '"  class="tree-delete">删除</a>'

        text += '&nbsp;<a data-id="' + id + '" data-pid="' + pid + '"  class="tree-edit">修改</a>'
        return text;
    }

    $(document).ready(function () {
        $.ajax({
            type: "GET",
            url: "/type/list",
            cache: false,  //禁用缓存
            data: {replyID: $(this).attr("data-id")},
            dataType: "json",
            success: function (result) {
                result.data.forEach(element => {
                    var treeItem = {text: getText(element.typeName, element.parentID, element.typeID)};

                    treeItem.nodes = [];
                    element.sonType.forEach(chlien => {
                        var chlienItem = {text: getText(chlien.typeName, chlien.parentID, chlien.typeID)};

                        treeItem.nodes.push(chlienItem);

                    });
                    tree.push(treeItem);
                });
                console.log(tree);
                $('#tree').treeview({data: tree});

            }
        });


        $("body").on("click", ".tree-add", function () {
            layer.open({
                type: 1,
                title: "工号新增",
                skin: 'layui-layer-rim', //加上边框
                area: ['500px', '450px'], //宽高
                content: $('#add'),
                btn: ['保存', '取消']
                , yes: function (index, layero) {
                    saveOrUpdate();
                }
                , btn2: function (index, layero) {
                    layer.closeAll();
                }
                , cancel: function () {
                    layer.closeAll();
                }
            });
        })


    });

</script>
<style>
    .form-control {
        width: 240px !important;
    }
</style>


</body>

</html>
